<!DOCTYPE html>

<html>
<head>
  <title>BAREBONE.JS</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="barebone-js">BAREBONE.JS</h1>
<p>A BAREBONE implementation of <a href="http://backbonejs.org/docs/backbone.html">Backbone.js</a> (only about 120 lines of code). </p>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Use this as a learning resource to:</p>
<ul>
<li>Demystify MVC frameworks <ul>
<li>Understand the magic under the hood</li>
<li>See how the components work together</li>
</ul>
</li>
<li>Review JavaScript fundamentals:<ul>
<li>this keyword</li>
<li>scopes &amp; closure</li>
<li>event system</li>
<li>instantiation</li>
<li>subclassing</li>
</ul>
</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Create a closure to avoid polluting the global scope by wrapping the framework in an IIFE.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Create BAREBONE object namespace.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> BAREBONE = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h2 id="barebone-events">BAREBONE EVENTS</h2>
<p>Event system giving the ability to bind and trigger custom named events.
This module will be added to the prototype of BAREBONE.Model, BAREBONE.Collection, and BAREBONE.View.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
  <span class="hljs-keyword">var</span> Events = BAREBONE.Events = {</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Method to bind an event to a callback function.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    on: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(name, callback, context)</span> </span>{
      <span class="hljs-keyword">this</span>._events || (<span class="hljs-keyword">this</span>._events = {}); 
      actions = <span class="hljs-keyword">this</span>._events[name] || (<span class="hljs-keyword">this</span>._events[name] = []); 
      actions.push({callback: callback, ctx: context || <span class="hljs-keyword">this</span>}); 
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Trigger an event, firing all bound callbacks. 
Callbacks are passed the same arguments that are passed to trigger.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    trigger: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(name)</span> </span>{
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._events) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
      <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>, <span class="hljs-number">1</span>);
      <span class="hljs-keyword">var</span> actions = <span class="hljs-keyword">this</span>._events[name] || [];
      _.each(actions, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(action)</span> </span>{
        action.callback.apply(action.ctx, args);
      });
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    }
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <h2 id="barebone-models">BAREBONE MODELS</h2>
<p>The basic data object in the framework - a discrete chunk of data and the logic surrouding it.
Model provides a basic set of functionality for managing changes.</p>

            </div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Create a new model with the specified attributes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> Model = BAREBONE.Model = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attributes)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Attach <code>attributes</code> (initial values) and <code>defaults</code> to model.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> attrs = attributes || {};
    attrs = _.defaults({}, attrs, _.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'defaults'</span>));
    <span class="hljs-keyword">this</span>.attributes = {}
    <span class="hljs-keyword">this</span>.set(attrs);</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Invoke <code>initialize</code>. First parameter to initialize will be model’s <code>attributes</code> object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.initialize.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>); 
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Attach all inheritable methods to the Model prototype.
Add the Events module so that the model can bind and trigger events.
Add model-specific methods.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _.extend(Model.prototype, Events, {</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Override with initialization logic. Empty function by default.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    initialize: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{},</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Get the value of an attribute.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    get: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attr)</span> </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.attributes[attr];
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Set or update the value of an attribute. </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    set: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(key, val)</span> </span>{

      <span class="hljs-keyword">var</span> attrs;

      <span class="hljs-keyword">if</span> (key == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Input may be object or string. Create <code>attrs</code> object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> key === <span class="hljs-string">'object'</span>) {
        attrs = key;
      } <span class="hljs-keyword">else</span> {
        (attrs = {})[key] = val;
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Add or change attribute in <code>this.attributes</code> object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> attr <span class="hljs-keyword">in</span> attrs) {
        <span class="hljs-keyword">this</span>.attributes[attr] = attrs[attr];
      }</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Trigger change event on object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'change'</span>, <span class="hljs-keyword">this</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    }
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Underscore methods to implement on the Model.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> modelMethods = [<span class="hljs-string">'keys'</span>, <span class="hljs-string">'values'</span>, <span class="hljs-string">'pairs'</span>, <span class="hljs-string">'invert'</span>, <span class="hljs-string">'pick'</span>, <span class="hljs-string">'omit'</span>, <span class="hljs-string">'chain'</span>, <span class="hljs-string">'isEmpty'</span>];</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Mix in Underscore methods as a proxy to the <code>model.attributes</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _.each(modelMethods, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(method)</span> </span>{
    Model.prototype[method] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);
      args.unshift(<span class="hljs-keyword">this</span>.attributes);
      <span class="hljs-keyword">return</span> _[method].apply(_, args);
    };
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <h2 id="barebone-collections">BAREBONE COLLECTIONS</h2>
<p>Collections are ordered sets of models.
Any event triggered on a model in a collection will also be triggered on the collection directly.</p>

            </div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Create a new collection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> Collection = BAREBONE.Collection = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(models)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Keep track of <code>length</code> and <code>models</code> in collection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.length = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.models = [];</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Invoke <code>initialize</code>. First argument to initialize will be models passed to Collection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.initialize.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Add models to <code>this.models</code> via the set method.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (models) <span class="hljs-keyword">this</span>.set(models);
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Attach all inheritable methods to the Collection prototype.
Add the Events module so that the collection can bind and trigger events.
Add collection-specific methods.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _.extend(Collection.prototype, Events, {</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Override with initialization logic. Empty function by default.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    initialize: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{},</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Add a model or list of models to the set.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    add: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(models)</span> </span>{
      <span class="hljs-keyword">var</span> added = <span class="hljs-keyword">this</span>.set(models);
      <span class="hljs-keyword">this</span>.trigger(<span class="hljs-string">'add'</span>, models);
      <span class="hljs-keyword">return</span> added;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Update collection by setting models.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    set: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(models)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Check if a single model is passed. Ensure <code>models</code> is an array.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> singular = !_.isArray(models);
      models = singular ? (models ? [models] : []) : models.slice();</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Add each model to <code>models</code> array and increment <code>length</code>.
Trigger ‘change’ event on collection when a contained model triggers ‘change’ event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">var</span> context = <span class="hljs-keyword">this</span>;
      _.each(models, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(model)</span> </span>{
        context.length++;
        context.models.push(model);
        model.on(<span class="hljs-string">'change'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(model)</span> </span>{
          context.trigger(<span class="hljs-string">'change'</span>, model);
        });
      });

      <span class="hljs-keyword">return</span> singular ? models[<span class="hljs-number">0</span>] : models;
    }
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Underscore methods to implement on the Collection:</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> methods = [<span class="hljs-string">'forEach'</span>, <span class="hljs-string">'each'</span>, <span class="hljs-string">'map'</span>, <span class="hljs-string">'collect'</span>, <span class="hljs-string">'reduce'</span>, <span class="hljs-string">'foldl'</span>,
    <span class="hljs-string">'inject'</span>, <span class="hljs-string">'reduceRight'</span>, <span class="hljs-string">'foldr'</span>, <span class="hljs-string">'find'</span>, <span class="hljs-string">'detect'</span>, <span class="hljs-string">'filter'</span>, <span class="hljs-string">'select'</span>,
    <span class="hljs-string">'reject'</span>, <span class="hljs-string">'every'</span>, <span class="hljs-string">'all'</span>, <span class="hljs-string">'some'</span>, <span class="hljs-string">'any'</span>, <span class="hljs-string">'include'</span>, <span class="hljs-string">'contains'</span>, <span class="hljs-string">'invoke'</span>,
    <span class="hljs-string">'max'</span>, <span class="hljs-string">'min'</span>, <span class="hljs-string">'toArray'</span>, <span class="hljs-string">'size'</span>, <span class="hljs-string">'first'</span>, <span class="hljs-string">'head'</span>, <span class="hljs-string">'take'</span>, <span class="hljs-string">'initial'</span>, <span class="hljs-string">'rest'</span>,
    <span class="hljs-string">'tail'</span>, <span class="hljs-string">'drop'</span>, <span class="hljs-string">'last'</span>, <span class="hljs-string">'without'</span>, <span class="hljs-string">'difference'</span>, <span class="hljs-string">'indexOf'</span>, <span class="hljs-string">'shuffle'</span>,
    <span class="hljs-string">'lastIndexOf'</span>, <span class="hljs-string">'isEmpty'</span>, <span class="hljs-string">'chain'</span>, <span class="hljs-string">'sample'</span>, <span class="hljs-string">'partition'</span>];</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Add Underscore methods as a proxy to <code>Collection.models</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _.each(methods, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(method)</span> </span>{
    <span class="hljs-keyword">if</span> (!_[method]) <span class="hljs-keyword">return</span>;
    Collection.prototype[method] = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);
      args.unshift(<span class="hljs-keyword">this</span>.models);
      <span class="hljs-keyword">return</span> _[method].apply(_, args);
    };
  });</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <h2 id="barebone-view">BAREBONE VIEW</h2>
<p>Provide convention to organize your interface into logical views, backed by models, each of which can be updated independently when the model changes, without having to redraw the whole page.
You no longer need to dig into a JSON object, look up an element on the DOM, and manually update the HTML. Simply bind your view’s <code>render</code> function to the model’s ‘change’ event.</p>

            </div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Create a new View.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> View = BAREBONE.View = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(options)</span> </span>{

    options || (options = {});</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Decorate View with options provided.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _.extend(<span class="hljs-keyword">this</span>, _.pick(options, viewOptions));</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Ensure that the View has a DOM element to render into.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>._ensureElement();</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Invoke <code>initialize</code>. First argument to initialize will be options passed to View.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">this</span>.initialize.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>List of view options to be merged as properties:</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> viewOptions = [<span class="hljs-string">'model'</span>, <span class="hljs-string">'collection'</span>, <span class="hljs-string">'el'</span>, <span class="hljs-string">'id'</span>, <span class="hljs-string">'attributes'</span>, <span class="hljs-string">'className'</span>, <span class="hljs-string">'tagName'</span>, <span class="hljs-string">'events'</span>];</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Cached regex to split keys for <code>delegate</code>:</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> delegateEventSplitter = <span class="hljs-regexp">/^(\S+)\s*(.*)$/</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Attach all inheritable methods to the View prototype.
Add the Events module so that the view can bind and trigger events.
Add view-specific methods.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _.extend(View.prototype, Events, {</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Default <code>tagName</code> of a View’s element is ‘div’.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    tagName: <span class="hljs-string">'div'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>jQuery delegate for element lookup, scoped to DOM elements within current view. Use this rather than global lookups.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    $: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(selector)</span> </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.$el.find(selector);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Override with initialization logic. Empty function by default.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    initialize: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{},</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Override with custom render function to populate view’s element (<code>this.el</code>) with appropriate HTML.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    render: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Ensure that the View has a DOM element to render into. Invoke <code>_setElement</code> method to set <code>this.el</code> and <code>this.$el</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _ensureElement: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.el) {
        <span class="hljs-keyword">this</span>._setElement(_.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'el'</span>));  
      } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>If <code>this.el</code> doesn’t exist, create an element from <code>id</code>, <code>className</code>, and <code>tagName</code> properties.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> attrs = _.extend({}, _.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'attributes'</span>));  
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.id) attr.id = _.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'id'</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.className) attrs.class = _.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'className'</span>);  
        <span class="hljs-keyword">this</span>._setElement(<span class="hljs-keyword">this</span>._createElement(_.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'tagName'</span>)));
        <span class="hljs-keyword">this</span>._setAttributes(attrs);
      }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>Produce a DOM element to be assigned to the view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _createElement: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(tagName)</span> </span>{
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.createElement(tagName);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>Create <code>this.el</code> and <code>this.$el</code> references and delegate the view’s events on the new element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _setElement: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(el)</span> </span>{
      <span class="hljs-keyword">this</span>.$el = el <span class="hljs-keyword">instanceof</span> $ ? el : $(el);
      <span class="hljs-keyword">this</span>.el = <span class="hljs-keyword">this</span>.$el[<span class="hljs-number">0</span>];
      <span class="hljs-keyword">this</span>.delegateEvents();
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>Set attributes from a hash on the view’s element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _setAttributes: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attrs)</span> </span>{
      <span class="hljs-keyword">this</span>.$el.attr(attrs);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>Iterate over events object {“event selector”: “callback”} and bind callbacks to the view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    delegateEvents: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">var</span> events = _.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'events'</span>) || {};
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> events) {
        <span class="hljs-keyword">var</span> method = events[key];</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>create array with DOM event and selector</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> match = key.match(delegateEventSplitter);
        <span class="hljs-keyword">this</span>.delegate(match[<span class="hljs-number">1</span>], match[<span class="hljs-number">2</span>], _.bind(method, <span class="hljs-keyword">this</span>));
      }
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>Add a single event listener to the view’s element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    delegate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(eventName, selector, listener)</span> </span>{
      <span class="hljs-keyword">this</span>.$el.on(eventName, selector, listener);
    }

  });</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <h2 id="helper-functions">HELPER FUNCTIONS</h2>

            </div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p><code>extend</code> returns a subclass (ex: Guest class) with a prototype object that contains 
user-specified properties, which delegates to the Model class. 
This is how the <code>initialize</code> method passed to the BAREBONE.Model.extend function
masks the default empty <code>initialize</code> method stored on BAREBONE.Model.prototype.</p>

            </div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>Helper functions to correctly set up prototype chain for subclasses. Examples below are for BAREBONE.Model and a Fish Model class.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">var</span> extend = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(protoProps)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p><code>this</code> is bound to a class, such as the BAREBONE.Model constructor function.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> Parent = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>Constructor function for the new subclass (ex: Fish) to be returned. Simply calls the Parent’s constructor (ex: BAREBONE.Model).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> Child = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
      <span class="hljs-keyword">return</span> Parent.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>); 
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p>Add static properties (those attached directly to the constructor function).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _.extend(Child, Parent);</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p>Set the prototype chain to inherit from <code>Parent</code> without calling the <code>Parent</code> constructor function.</p>

            </div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p>Surrogate returns the Child.prototype object (ex: Fish.prototype) with the correct constructor property (ex: Fish).
The returned Child.prototype object (ex: Fish.prototype) delegates to the Parent.prototype (ex: Model.prototype).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> Surrogate = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-keyword">this</span>.constructor = Child; };   
    Surrogate.prototype = Parent.prototype;
    Child.prototype = <span class="hljs-keyword">new</span> Surrogate;</pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>Decorate subclass prototype (ex: Fish.prototype) with supplied prototype properties (instance properties).
Properties on Child.prototype will mask properties on Parent.prototype (such as the user-defined <code>initialize</code> method, or <code>tagName</code> on Views). </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (protoProps) _.extend(Child.prototype, protoProps);
    <span class="hljs-keyword">return</span> Child;
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p>Set up inheritance for the model, collection, and view.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  Model.extend = Collection.extend = View.extend = extend;</pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p>Attach BAREBONE library to window object, creating a closure.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-built_in">window</span>.BAREBONE = BAREBONE;

})();</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
